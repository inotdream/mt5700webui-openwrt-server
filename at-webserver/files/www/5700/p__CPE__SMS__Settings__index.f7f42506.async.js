"use strict";(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[516],{69285:function(er,X,p){p.r(X);var pe=p(97857),D=p.n(pe),ge=p(15009),m=p.n(ge),ve=p(64599),Ee=p.n(ve),Se=p(99289),b=p.n(Se),Fe=p(5574),_=p.n(Fe),Ce=p(59955),L=p(33160),De=p(69753),be=p(88484),Q=p(82061),Pe=p(8232),c=p(2453),N=p(33900),O=p(78957),R=p(36039),j=p(77683),M=p(26412),_e=p(72269),Me=p(60801),$=p(78045),z=p(38703),Be=p(78367),B=p(67294),r=p(85893),rr=3e3,ur=8e3,H="sms_sent_messages_cache",we=function(){var Ae=Pe.Z.useForm(),Te=_()(Ae,1),nr=Te[0],je=(0,B.useState)(!1),q=_()(je,2),x=q[0],Z=q[1],ye=(0,B.useState)(!1),ee=_()(ye,2),re=ee[0],W=ee[1],Ze=(0,B.useState)(!1),ue=_()(Ze,2),sr=ue[0],ae=ue[1],Oe=(0,B.useState)(!1),ne=_()(Oe,2),tr=ne[0],se=ne[1],ke=(0,B.useState)(!1),te=_()(ke,2),ir=te[0],Ue=te[1],Ie=(0,B.useState)(!1),ie=_()(Ie,2),lr=ie[0],or=ie[1],Le=(0,B.useState)(!1),le=_()(Le,2),Re=le[0],oe=le[1],We=(0,B.useState)({forwardingNumber:"",smsCenterNumber:"",enableForwarding:!1,enableSMS:!1}),ce=_()(We,2),w=ce[0],k=ce[1],Ke=(0,B.useState)({read:"SM",write:"SM",receive:"SM"}),de=_()(Ke,2),C=de[0],G=de[1],Ne=(0,B.useState)(!1),fe=_()(Ne,2),me=fe[0],J=fe[1],T=Ce.S.getInstance(),I=function(){try{var a=localStorage.getItem(H);if(a){var n=JSON.parse(a);return Array.isArray(n)?n:[]}}catch(t){console.error("\u4ECE\u672C\u5730\u7F13\u5B58\u52A0\u8F7D\u53D1\u9001\u6D88\u606F\u5931\u8D25:",t)}return[]},he=function(){try{localStorage.removeItem(H),console.log("\u5DF2\u6E05\u7A7A\u53D1\u9001\u6D88\u606F\u7F13\u5B58")}catch(a){console.error("\u6E05\u7A7A\u53D1\u9001\u6D88\u606F\u7F13\u5B58\u5931\u8D25:",a)}},$e=function(){try{var a=I();if(a.length===0){c.ZP.warning("\u6CA1\u6709\u7F13\u5B58\u7684\u53D1\u9001\u6D88\u606F\u53EF\u4EE5\u5BFC\u51FA");return}var n={exportTime:new Date().toISOString(),version:"1.0",messageCount:a.length,messages:a},t=new Blob([JSON.stringify(n,null,2)],{type:"application/json"}),i=URL.createObjectURL(t),e=document.createElement("a");e.href=i,e.download="sms_cache_export_".concat(new Date().toISOString().split("T")[0],".json"),document.body.appendChild(e),e.click(),document.body.removeChild(e),URL.revokeObjectURL(i),c.ZP.success("\u6210\u529F\u5BFC\u51FA ".concat(a.length," \u6761\u53D1\u9001\u6D88\u606F"))}catch(h){console.error("\u5BFC\u51FA\u7F13\u5B58\u5931\u8D25:",h),c.ZP.error("\u5BFC\u51FA\u7F13\u5B58\u5931\u8D25")}},ze=function(a){var n=new FileReader;n.onload=function(t){try{var i,e=(i=t.target)===null||i===void 0?void 0:i.result,h=JSON.parse(e);if(!h.messages||!Array.isArray(h.messages)){c.ZP.error("\u5BFC\u5165\u6587\u4EF6\u683C\u5F0F\u4E0D\u6B63\u786E");return}var v=h.messages.filter(function(l){return l&&typeof l.content=="string"&&typeof l.number=="string"&&typeof l.time=="string"&&l.type==="sent"});if(v.length===0){c.ZP.error("\u5BFC\u5165\u6587\u4EF6\u4E2D\u6CA1\u6709\u6709\u6548\u7684\u53D1\u9001\u6D88\u606F");return}N.Z.confirm({title:"\u786E\u8BA4\u5BFC\u5165",content:"\u786E\u5B9A\u8981\u5BFC\u5165 ".concat(v.length," \u6761\u53D1\u9001\u6D88\u606F\u5417\uFF1F\u8FD9\u5C06\u8986\u76D6\u73B0\u6709\u7684\u672C\u5730\u7F13\u5B58\u3002"),okText:"\u5BFC\u5165",cancelText:"\u53D6\u6D88",okButtonProps:{danger:!0},onOk:function(){try{localStorage.setItem(H,JSON.stringify(v)),c.ZP.success("\u6210\u529F\u5BFC\u5165 ".concat(v.length," \u6761\u53D1\u9001\u6D88\u606F"))}catch(u){console.error("\u5BFC\u5165\u7F13\u5B58\u5931\u8D25:",u),c.ZP.error("\u5BFC\u5165\u7F13\u5B58\u5931\u8D25")}}})}catch(l){console.error("\u89E3\u6790\u5BFC\u5165\u6587\u4EF6\u5931\u8D25:",l),c.ZP.error("\u5BFC\u5165\u6587\u4EF6\u683C\u5F0F\u9519\u8BEF")}},n.readAsText(a)},He=function(){var a=I();if(a.length===0){c.ZP.warning("\u6CA1\u6709\u7F13\u5B58\u7684\u53D1\u9001\u6D88\u606F\u53EF\u4EE5\u6E05\u7A7A");return}N.Z.confirm({title:"\u786E\u8BA4\u6E05\u7A7A\u7F13\u5B58",content:"\u786E\u5B9A\u8981\u6E05\u7A7A\u672C\u5730\u53D1\u9001\u6D88\u606F\u7F13\u5B58\u5417\uFF1F\u8FD9\u5C06\u5220\u9664 ".concat(a.length," \u6761\u53D1\u9001\u6D88\u606F\u8BB0\u5F55\uFF0C\u6B64\u64CD\u4F5C\u65E0\u6CD5\u64A4\u9500\u3002"),okText:"\u6E05\u7A7A",cancelText:"\u53D6\u6D88",okButtonProps:{danger:!0},onOk:function(){he(),c.ZP.success("\u672C\u5730\u7F13\u5B58\u5DF2\u6E05\u7A7A")}})},Ge=function(){var o=b()(m()().mark(function a(){return m()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:N.Z.confirm({title:"\u786E\u8BA4\u6E05\u7A7A\u6240\u6709\u77ED\u4FE1",content:(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{children:"\u786E\u5B9A\u8981\u6E05\u7A7A\u8BBE\u5907\u4E0A\u7684\u6240\u6709\u77ED\u4FE1\u5417\uFF1F"}),(0,r.jsx)("p",{style:{color:"#ff4d4f",fontWeight:"bold"},children:"\u6B64\u64CD\u4F5C\u5C06\u5220\u9664\u8BBE\u5907\u4E0A\u5B58\u50A8\u7684\u6240\u6709\u77ED\u4FE1\uFF08\u5305\u62EC\u5DF2\u8BFB\u548C\u672A\u8BFB\uFF09\uFF0C\u6B64\u64CD\u4F5C\u65E0\u6CD5\u64A4\u9500\uFF01"})]}),okText:"\u786E\u8BA4\u6E05\u7A7A",cancelText:"\u53D6\u6D88",okButtonProps:{danger:!0},onOk:function(){var i=b()(m()().mark(function h(){var v,l,u,s,E,F,f,g,A,y,S;return m()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.prev=0,oe(!0),c.ZP.loading({content:"\u6B63\u5728\u6E05\u7A7A\u6240\u6709\u77ED\u4FE1\uFF0C\u8BF7\u7A0D\u5019...",key:"clearAllSms",duration:0}),d.next=5,T.sendCommand("AT+CPMS?");case 5:if(v=d.sent,v.success){d.next=8;break}throw new Error("\u83B7\u53D6\u5B58\u50A8\u914D\u7F6E\u5931\u8D25");case 8:if(l=typeof v.data=="string"?v.data:String(v.data),u=l.match(/\+CPMS: "(\w+)",(\d+),(\d+),"(\w+)",(\d+),(\d+),"(\w+)",(\d+),(\d+)/),u){d.next=12;break}throw new Error("\u89E3\u6790\u5B58\u50A8\u914D\u7F6E\u5931\u8D25");case 12:s=u[1],E=u[4],F=u[7],f=[s,E,F].filter(function(U,qe,xe){return xe.indexOf(U)===qe}),console.log("\u9700\u8981\u6E05\u7A7A\u7684\u5B58\u50A8\u4F4D\u7F6E:",f),g=Ee()(f),d.prev=18,g.s();case 20:if((A=g.n()).done){d.next=39;break}return y=A.value,console.log("\u6B63\u5728\u6E05\u7A7A\u5B58\u50A8\u4F4D\u7F6E: ".concat(y)),d.next=25,T.sendCommand("AT+CMGF=0");case 25:return d.next=27,new Promise(function(U){return setTimeout(U,500)});case 27:return d.next=29,T.sendCommand('AT+CPMS="'.concat(y,'","').concat(y,'","').concat(y,'"'));case 29:return d.next=31,new Promise(function(U){return setTimeout(U,500)});case 31:return d.next=33,T.sendCommand("AT+CMGD=1,4");case 33:return S=d.sent,S.success||console.warn("\u6E05\u7A7A\u5B58\u50A8\u4F4D\u7F6E ".concat(y," \u5931\u8D25:"),S.error),d.next=37,new Promise(function(U){return setTimeout(U,1e3)});case 37:d.next=20;break;case 39:d.next=44;break;case 41:d.prev=41,d.t0=d.catch(18),g.e(d.t0);case 44:return d.prev=44,g.f(),d.finish(44);case 47:c.ZP.destroy("clearAllSms"),c.ZP.success("\u6240\u6709\u77ED\u4FE1\u5DF2\u6E05\u7A7A"),he(),d.next=57;break;case 52:d.prev=52,d.t1=d.catch(0),c.ZP.destroy("clearAllSms"),console.error("\u6E05\u7A7A\u6240\u6709\u77ED\u4FE1\u5931\u8D25:",d.t1),c.ZP.error("\u6E05\u7A7A\u6240\u6709\u77ED\u4FE1\u5931\u8D25\uFF1A"+(d.t1 instanceof Error?d.t1.message:"\u672A\u77E5\u9519\u8BEF"));case 57:return d.prev=57,oe(!1),d.finish(57);case 60:case"end":return d.stop()}},h,null,[[0,52,57,60],[18,41,44,47]])}));function e(){return i.apply(this,arguments)}return e}()});case 1:case"end":return t.stop()}},a)}));return function(){return o.apply(this,arguments)}}();(0,B.useEffect)(function(){var o=!0,a=function(){var n=b()(m()().mark(function t(){var i,e,h;return m()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return i=function(){var u=b()(m()().mark(function s(){var E,F,f,g,A=arguments;return m()().wrap(function(S){for(;;)switch(S.prev=S.next){case 0:E=A.length>0&&A[0]!==void 0?A[0]:3,F=A.length>1&&A[1]!==void 0?A[1]:1e3,f=0;case 3:if(!(f<E)){S.next=25;break}return S.prev=4,S.next=7,T.connect();case 7:if(g=S.sent,!g){S.next=10;break}return S.abrupt("return",!0);case 10:if(console.log("\u8FDE\u63A5\u5C1D\u8BD5 ".concat(f+1," \u5931\u8D25\uFF0C").concat(f<E-1?"\u5C06\u91CD\u8BD5":"\u5DF2\u8FBE\u5230\u6700\u5927\u91CD\u8BD5\u6B21\u6570")),!(f<E-1)){S.next=14;break}return S.next=14,new Promise(function(P){return setTimeout(P,F)});case 14:S.next=22;break;case 16:if(S.prev=16,S.t0=S.catch(4),console.error("\u8FDE\u63A5\u5C1D\u8BD5 ".concat(f+1," \u5931\u8D25:"),S.t0),!(f<E-1)){S.next=22;break}return S.next=22,new Promise(function(P){return setTimeout(P,F)});case 22:f++,S.next=3;break;case 25:return S.abrupt("return",!1);case 26:case"end":return S.stop()}},s,null,[[4,16]])}));return function(){return u.apply(this,arguments)}}(),l.prev=1,o&&Z(!0),l.next=5,i();case 5:if(e=l.sent,e){l.next=9;break}return o&&(c.ZP.error("\u8FDE\u63A5\u5230\u8BBE\u5907\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC\u8FDE\u63A5"),Z(!1)),l.abrupt("return");case 9:return h=function(){var u=b()(m()().mark(function s(){var E;return m()().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:if(o){f.next=2;break}return f.abrupt("return");case 2:return f.prev=2,f.next=5,V(!1);case 5:E=f.sent,f.next=11;break;case 8:f.prev=8,f.t0=f.catch(2),console.error("\u83B7\u53D6\u77ED\u4FE1\u529F\u80FD\u72B6\u6001\u5931\u8D25:",f.t0);case 11:return f.prev=11,o&&Z(!1),f.finish(11);case 14:case"end":return f.stop()}},s,null,[[2,8,11,14]])}));return function(){return u.apply(this,arguments)}}(),l.next=12,h();case 12:setTimeout(function(){o&&(Y(!1).catch(function(u){console.error("\u83B7\u53D6\u5B58\u50A8\u914D\u7F6E\u5931\u8D25:",u)}),Xe(!1).catch(function(u){console.error("\u83B7\u53D6\u9AD8\u7EA7\u8BBE\u7F6E\u5931\u8D25:",u)}))},1e3),l.next=19;break;case 15:l.prev=15,l.t0=l.catch(1),console.error("\u521D\u59CB\u5316\u8BBE\u7F6E\u5931\u8D25:",l.t0),o&&Z(!1);case 19:case"end":return l.stop()}},t,null,[[1,15]])}));return function(){return n.apply(this,arguments)}}();return a(),function(){o=!1,T.disconnect()}},[]);var K=function(){var o=b()(m()().mark(function a(n){var t,i,e,h,v=arguments;return m()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:t=v.length>1&&v[1]!==void 0?v[1]:3,i=v.length>2&&v[2]!==void 0?v[2]:1e3,e=0;case 3:if(!(e<t)){u.next=25;break}return u.prev=4,u.next=7,T.sendCommand(n);case 7:if(h=u.sent,!h.success){u.next=10;break}return u.abrupt("return",h);case 10:if(!(e<t-1)){u.next=13;break}return u.next=13,new Promise(function(s){return setTimeout(s,i)});case 13:u.next=22;break;case 15:if(u.prev=15,u.t0=u.catch(4),console.error("Command ".concat(n," failed on attempt ").concat(e+1,":"),u.t0),e!==t-1){u.next=20;break}throw u.t0;case 20:return u.next=22,new Promise(function(s){return setTimeout(s,i)});case 22:e++,u.next=3;break;case 25:throw new Error("Command ".concat(n," failed after ").concat(t," retries"));case 26:case"end":return u.stop()}},a,null,[[4,15]])}));return function(n){return o.apply(this,arguments)}}(),V=function(){var o=b()(m()().mark(function a(){var n,t,i,e,h,v,l=arguments;return m()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return n=l.length>0&&l[0]!==void 0?l[0]:!0,s.prev=1,n&&W(!0),s.next=5,K("AT^IMSSWITCH?");case 5:if(t=s.sent,!(!t.success||!t.data||typeof t.data!="string")){s.next=8;break}throw new Error("\u83B7\u53D6\u77ED\u4FE1\u529F\u80FD\u72B6\u6001\u5931\u8D25");case 8:if(i=t.data.match(/\^IMSSWITCH:\s*(\d+),\d+,\d+/),i){s.next=11;break}throw new Error("\u89E3\u6790\u77ED\u4FE1\u529F\u80FD\u72B6\u6001\u5931\u8D25");case 11:if(e=i[1]==="1",k(function(E){return D()(D()({},E),{},{enableSMS:e})}),!e){s.next=26;break}return s.prev=14,s.next=17,new Promise(function(E){return setTimeout(E,300)});case 17:return s.next=19,K("AT+CSCA?");case 19:h=s.sent,h.success&&h.data&&typeof h.data=="string"&&(v=h.data.match(/\+CSCA: "([^"]+)"/),v&&k(function(E){return D()(D()({},E),{},{smsCenterNumber:v[1]})})),s.next=26;break;case 23:s.prev=23,s.t0=s.catch(14),console.error("\u83B7\u53D6\u77ED\u4FE1\u4E2D\u5FC3\u53F7\u7801\u5931\u8D25:",s.t0);case 26:return n&&c.ZP.success("\u77ED\u4FE1\u529F\u80FD\u72B6\u6001\u5DF2\u5237\u65B0"),s.abrupt("return",!0);case 30:return s.prev=30,s.t1=s.catch(1),console.error("\u83B7\u53D6\u77ED\u4FE1\u529F\u80FD\u72B6\u6001\u5931\u8D25:",s.t1),n&&c.ZP.error("\u83B7\u53D6\u77ED\u4FE1\u529F\u80FD\u72B6\u6001\u5931\u8D25\uFF0C\u8BF7\u7A0D\u540E\u91CD\u8BD5"),s.abrupt("return",!1);case 35:return s.prev=35,n&&W(!1),s.finish(35);case 38:case"end":return s.stop()}},a,null,[[1,30,35,38],[14,23]])}));return function(){return o.apply(this,arguments)}}(),Je=function(){var o=b()(m()().mark(function a(){var n;return m()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(i.prev=0,W(!0),!w.smsCenterNumber){i.next=11;break}return i.next=5,T.sendCommand('AT+CSCA="'.concat(w.smsCenterNumber,'"'));case 5:if(n=i.sent,n.success){i.next=8;break}throw new Error("\u8BBE\u7F6E\u77ED\u4FE1\u4E2D\u5FC3\u53F7\u7801\u5931\u8D25");case 8:c.ZP.success("\u77ED\u4FE1\u4E2D\u5FC3\u53F7\u7801\u8BBE\u7F6E\u6210\u529F"),i.next=12;break;case 11:c.ZP.warning("\u8BF7\u8F93\u5165\u77ED\u4FE1\u4E2D\u5FC3\u53F7\u7801");case 12:i.next=17;break;case 14:i.prev=14,i.t0=i.catch(0),c.ZP.error("\u8BBE\u7F6E\u4FDD\u5B58\u5931\u8D25");case 17:return i.prev=17,W(!1),i.finish(17);case 20:case"end":return i.stop()}},a,null,[[0,14,17,20]])}));return function(){return o.apply(this,arguments)}}(),Ve=function(){var o=b()(m()().mark(function a(n){var t,i,e,h,v;return m()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:u.prev=0,Z(!0),t=!0,i=n?[["AT+CFUN=0",2e3,"\u6B63\u5728\u5F00\u542F\u98DE\u884C\u6A21\u5F0F..."],['AT+CGDCONT=5,"IPV4V6","ims","",0,0,0,0,1,1,1,,,,,,0,,0,0,0,0',0,"\u6B63\u5728\u914D\u7F6EIMS\u53C2\u6570..."],["AT+CEUS=0",1e3,"\u6B63\u5728\u8BBE\u7F6EEPS\u670D\u52A1..."],["AT^IMSSWITCH=1,0,0",1e3,"\u6B63\u5728\u5F00\u542FIMS\u529F\u80FD..."],["AT+CFUN=1",2e3,"\u6B63\u5728\u5173\u95ED\u98DE\u884C\u6A21\u5F0F..."]]:[["AT+CFUN=0",2e3,"\u6B63\u5728\u5F00\u542F\u98DE\u884C\u6A21\u5F0F..."],['AT+CGDCONT=5,"IPV4V6","","",0,0,0,0,1,1,1,,,,,,0,,0,0,0,0',0,"\u6B63\u5728\u6E05\u9664IMS\u53C2\u6570..."],["AT+CEUS=1",1e3,"\u6B63\u5728\u5173\u95EDEPS\u670D\u52A1..."],["AT^IMSSWITCH=0,0,0",1e3,"\u6B63\u5728\u5173\u95EDIMS\u529F\u80FD..."],["AT+CFUN=1",2e3,"\u6B63\u5728\u5173\u95ED\u98DE\u884C\u6A21\u5F0F..."]],e=m()().mark(function s(){var E,F,f,g,A,y;return m()().wrap(function(P){for(;;)switch(P.prev=P.next){case 0:if(E=v[h],F=_()(E,3),f=F[0],g=F[1],A=F[2],typeof f=="string"){P.next=4;break}throw new Error("Command is not a string");case 4:return c.ZP.loading({content:A,key:"smsToggleStep",duration:0}),P.next=7,T.sendCommand(f);case 7:if(y=P.sent,y.success){P.next=12;break}return console.error("Command ".concat(f," failed")),t=!1,P.abrupt("return",1);case 12:if(!(typeof g=="number"&&g>0)){P.next=15;break}return P.next=15,new Promise(function(d){return setTimeout(d,g)});case 15:case"end":return P.stop()}},s)}),h=0,v=i;case 6:if(!(h<v.length)){u.next=13;break}return u.delegateYield(e(),"t0",8);case 8:if(!u.t0){u.next=10;break}return u.abrupt("break",13);case 10:h++,u.next=6;break;case 13:if(c.ZP.destroy("smsToggleStep"),!t){u.next=19;break}k(function(s){return D()(D()({},s),{},{enableSMS:n})}),c.ZP.success("\u77ED\u4FE1\u529F\u80FD\u5DF2".concat(n?"\u5F00\u542F":"\u5173\u95ED")),u.next=20;break;case 19:throw new Error("".concat(n?"\u5F00\u542F":"\u5173\u95ED","\u77ED\u4FE1\u529F\u80FD\u5931\u8D25"));case 20:u.next=28;break;case 22:u.prev=22,u.t1=u.catch(0),c.ZP.destroy("smsToggleStep"),console.error("Error toggling SMS:",u.t1),k(function(s){return D()(D()({},s),{},{enableSMS:!n})}),c.ZP.error("".concat(n?"\u5F00\u542F":"\u5173\u95ED","\u77ED\u4FE1\u529F\u80FD\u5931\u8D25"));case 28:return u.prev=28,Z(!1),u.finish(28);case 31:case"end":return u.stop()}},a,null,[[0,22,28,31]])}));return function(n){return o.apply(this,arguments)}}(),cr=function(){var o=b()(m()().mark(function a(){return m()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:try{ae(!0),k(function(i){return D()(D()({},i),{},{enableForwarding:!i.enableForwarding})}),c.ZP.success("\u8F6C\u53D1\u8BBE\u7F6E\u5DF2\u66F4\u65B0")}catch(i){c.ZP.error("\u8F6C\u53D1\u8BBE\u7F6E\u5931\u8D25")}finally{ae(!1)}case 1:case"end":return t.stop()}},a)}));return function(){return o.apply(this,arguments)}}(),dr=function(){var o=b()(m()().mark(function a(){var n,t;return m()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,se(!0),e.next=4,T.sendCommand("AT+WEBHOOK?");case 4:n=e.sent,n.success&&n.data&&typeof n.data=="string"&&(t=n.data.match(/\+WEBHOOK:\s*(\d+),"([^"]+)"/),t&&k(function(h){return D()(D()({},h),{},{enableWebhook:t[1]==="1",webhookUrl:t[2]})})),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(0),console.error("\u83B7\u53D6 Webhook \u914D\u7F6E\u5931\u8D25:",e.t0),c.ZP.error("\u83B7\u53D6 Webhook \u914D\u7F6E\u5931\u8D25");case 12:return e.prev=12,se(!1),e.finish(12);case 15:case"end":return e.stop()}},a,null,[[0,8,12,15]])}));return function(){return o.apply(this,arguments)}}(),Y=function(){var o=b()(m()().mark(function a(){var n,t,i,e,h=arguments;return m()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return n=h.length>0&&h[0]!==void 0?h[0]:!0,l.prev=1,t=new Promise(function(u,s){setTimeout(function(){return s(new Error("\u83B7\u53D6\u5B58\u50A8\u914D\u7F6E\u8D85\u65F6"))},5e3)}),i=function(){var u=b()(m()().mark(function s(){var E,F;return m()().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.prev=0,g.next=3,K("AT+CMGF=0");case 3:return g.next=5,K("AT+CPMS?");case 5:if(E=g.sent,!(E.success&&E.data&&typeof E.data=="string")){g.next=11;break}if(F=E.data.match(/\+CPMS: "(\w+)",(\d+),(\d+),"(\w+)",(\d+),(\d+),"(\w+)",(\d+),(\d+)/),!F){g.next=11;break}return G({read:F[1],readUsed:parseInt(F[2]),readTotal:parseInt(F[3]),write:F[4],writeUsed:parseInt(F[5]),writeTotal:parseInt(F[6]),receive:F[7],receiveUsed:parseInt(F[8]),receiveTotal:parseInt(F[9])}),g.abrupt("return",!0);case 11:return g.abrupt("return",!1);case 14:return g.prev=14,g.t0=g.catch(0),console.error("\u83B7\u53D6\u5B58\u50A8\u914D\u7F6E\u5931\u8D25:",g.t0),g.abrupt("return",!1);case 18:case"end":return g.stop()}},s,null,[[0,14]])}));return function(){return u.apply(this,arguments)}}(),l.next=6,Promise.race([i(),t]).catch(function(u){return console.error("\u83B7\u53D6\u5B58\u50A8\u914D\u7F6E\u8D85\u65F6:",u),n&&c.ZP.warning("\u83B7\u53D6\u5B58\u50A8\u914D\u7F6E\u8D85\u65F6\uFF0C\u5C06\u4F7F\u7528\u9ED8\u8BA4\u503C"),G(function(s){return D()(D()({},s),{},{readUsed:0,readTotal:50,writeUsed:0,writeTotal:50,receiveUsed:0,receiveTotal:50})}),!1});case 6:return e=l.sent,e&&n&&c.ZP.success("\u5B58\u50A8\u914D\u7F6E\u5DF2\u5237\u65B0"),l.abrupt("return",e);case 11:return l.prev=11,l.t0=l.catch(1),console.error("\u83B7\u53D6\u5B58\u50A8\u914D\u7F6E\u5931\u8D25:",l.t0),n&&c.ZP.error("\u83B7\u53D6\u5B58\u50A8\u914D\u7F6E\u5931\u8D25"),l.abrupt("return",!1);case 16:return l.prev=16,J(!1),l.finish(16);case 19:case"end":return l.stop()}},a,null,[[1,11,16,19]])}));return function(){return o.apply(this,arguments)}}(),Ye=function(){var o=b()(m()().mark(function a(){var n,t;return m()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,J(!0),n='AT+CPMS="'.concat(C.read,'","').concat(C.write,'","').concat(C.receive,'"'),e.next=5,T.sendCommand(n);case 5:if(t=e.sent,!t.success){e.next=12;break}return c.ZP.success("\u5B58\u50A8\u914D\u7F6E\u5DF2\u66F4\u65B0"),e.next=10,Y();case 10:e.next=13;break;case 12:throw new Error("\u8BBE\u7F6E\u5B58\u50A8\u914D\u7F6E\u5931\u8D25");case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(0),c.ZP.error("\u5B58\u50A8\u914D\u7F6E\u66F4\u65B0\u5931\u8D25");case 18:return e.prev=18,J(!1),e.finish(18);case 21:case"end":return e.stop()}},a,null,[[0,15,18,21]])}));return function(){return o.apply(this,arguments)}}(),Xe=function(){var o=b()(m()().mark(function a(){var n,t=arguments;return m()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.length>0&&t[0]!==void 0?t[0]:!0,e.prev=1,n&&c.ZP.success("\u9AD8\u7EA7\u8BBE\u7F6E\u5DF2\u5237\u65B0"),e.abrupt("return",!0);case 6:return e.prev=6,e.t0=e.catch(1),console.error("\u5237\u65B0\u9AD8\u7EA7\u8BBE\u7F6E\u5931\u8D25:",e.t0),n&&c.ZP.error("\u5237\u65B0\u9AD8\u7EA7\u8BBE\u7F6E\u5931\u8D25"),e.abrupt("return",!1);case 11:return e.prev=11,Ue(!1),e.finish(11);case 14:case"end":return e.stop()}},a,null,[[1,6,11,14]])}));return function(){return o.apply(this,arguments)}}(),Qe=function(a){G(function(n){return D()(D()({},n),{},{read:a,write:a,receive:a})})};return(0,B.useEffect)(function(){w.enableSMS},[w.enableSMS]),(0,r.jsx)("div",{children:(0,r.jsxs)(O.Z,{direction:"vertical",size:"middle",style:{display:"flex",width:"100%"},children:[(0,r.jsx)(R.Z,{title:"\u77ED\u4FE1\u529F\u80FD",extra:(0,r.jsx)(j.ZP,{icon:(0,r.jsx)(L.Z,{}),onClick:function(){Z(!0),V(!0).finally(function(){Z(!1)})},loading:x,children:"\u5237\u65B0"}),children:(0,r.jsx)(M.Z,{column:{xs:1,sm:1,md:1},bordered:!0,children:(0,r.jsx)(M.Z.Item,{label:"\u77ED\u4FE1\u5F00\u5173",span:1,children:(0,r.jsxs)(O.Z,{children:[(0,r.jsx)(_e.Z,{checked:w.enableSMS,onChange:function(a){return Ve(a)},loading:x}),(0,r.jsx)("span",{children:w.enableSMS?"\u5DF2\u5F00\u542F":"\u5DF2\u5173\u95ED"})]})})})}),(0,r.jsx)(R.Z,{title:"\u77ED\u4FE1\u4E2D\u5FC3\u8BBE\u7F6E",extra:(0,r.jsx)(j.ZP,{icon:(0,r.jsx)(L.Z,{}),onClick:function(){return V(!0)},loading:re,children:"\u5237\u65B0"}),children:(0,r.jsx)(M.Z,{column:{xs:1,sm:1,md:1},bordered:!0,children:(0,r.jsxs)(M.Z.Item,{label:"\u77ED\u4FE1\u4E2D\u5FC3\u53F7\u7801",span:1,children:[(0,r.jsxs)(O.Z.Compact,{style:{width:"100%",maxWidth:400},children:[(0,r.jsx)(Me.Z,{value:w.smsCenterNumber,onChange:function(a){return k(function(n){return D()(D()({},n),{},{smsCenterNumber:a.target.value})})},placeholder:"\u8BF7\u8F93\u5165\u77ED\u4FE1\u4E2D\u5FC3\u53F7\u7801",disabled:!w.enableSMS}),(0,r.jsx)(j.ZP,{type:"primary",onClick:Je,loading:re,disabled:!w.enableSMS,children:"\u4FDD\u5B58"})]}),!w.enableSMS&&(0,r.jsx)("div",{style:{marginTop:8,color:"#999"},children:"(\u8BF7\u5148\u5F00\u542F\u77ED\u4FE1\u529F\u80FD)"})]})})}),(0,r.jsx)(R.Z,{title:"\u5B58\u50A8\u8BBE\u7F6E",extra:(0,r.jsx)(j.ZP,{icon:(0,r.jsx)(L.Z,{}),onClick:function(){return Y(!0)},loading:me,children:"\u5237\u65B0"}),children:(0,r.jsxs)(O.Z,{direction:"vertical",style:{width:"100%"},children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{style:{marginBottom:16},children:[(0,r.jsx)("span",{style:{marginRight:8},children:"\u5B58\u50A8\u4F4D\u7F6E\uFF1A"}),(0,r.jsxs)($.ZP.Group,{value:C.read,onChange:function(a){return Qe(a.target.value)},children:[(0,r.jsx)($.ZP,{value:"SM",children:"SIM\u5361"}),(0,r.jsx)($.ZP,{value:"ME",children:"\u6A21\u7EC4"})]})]}),(0,r.jsxs)(M.Z,{bordered:!0,column:1,children:[(0,r.jsx)(M.Z.Item,{label:"\u8BFB\u53D6\u5B58\u50A8",children:(0,r.jsxs)("div",{style:{width:"100%"},children:[(0,r.jsxs)("div",{style:{marginBottom:4,fontSize:"12px",color:"#666"},children:["\u5DF2\u4F7F\u7528 ",C.readUsed||0,"/",C.readTotal||0]}),(0,r.jsx)(z.Z,{percent:Math.round((C.readUsed||0)/(C.readTotal||1)*100),size:"small",status:(C.readUsed||0)/(C.readTotal||1)>.9?"exception":"normal"})]})}),(0,r.jsx)(M.Z.Item,{label:"\u5199\u5165\u5B58\u50A8",children:(0,r.jsxs)("div",{style:{width:"100%"},children:[(0,r.jsxs)("div",{style:{marginBottom:4,fontSize:"12px",color:"#666"},children:["\u5DF2\u4F7F\u7528 ",C.writeUsed||0,"/",C.writeTotal||0]}),(0,r.jsx)(z.Z,{percent:Math.round((C.writeUsed||0)/(C.writeTotal||1)*100),size:"small",status:(C.writeUsed||0)/(C.writeTotal||1)>.9?"exception":"normal"})]})}),(0,r.jsx)(M.Z.Item,{label:"\u63A5\u6536\u5B58\u50A8",children:(0,r.jsxs)("div",{style:{width:"100%"},children:[(0,r.jsxs)("div",{style:{marginBottom:4,fontSize:"12px",color:"#666"},children:["\u5DF2\u4F7F\u7528 ",C.receiveUsed||0,"/",C.receiveTotal||0]}),(0,r.jsx)(z.Z,{percent:Math.round((C.receiveUsed||0)/(C.receiveTotal||1)*100),size:"small",status:(C.receiveUsed||0)/(C.receiveTotal||1)>.9?"exception":"normal"})]})})]})]}),(0,r.jsx)("div",{style:{textAlign:"right"},children:(0,r.jsx)(j.ZP,{type:"primary",onClick:Ye,loading:me,children:"\u4FDD\u5B58\u5B58\u50A8\u8BBE\u7F6E"})})]})}),(0,r.jsx)(R.Z,{title:"\u7F13\u5B58\u7BA1\u7406",extra:(0,r.jsx)(j.ZP,{icon:(0,r.jsx)(L.Z,{}),onClick:function(){var a=I();c.ZP.info("\u5F53\u524D\u7F13\u5B58\u4E86 ".concat(a.length," \u6761\u53D1\u9001\u6D88\u606F"))},children:"\u67E5\u770B\u72B6\u6001"}),children:(0,r.jsxs)(M.Z,{column:{xs:1,sm:1,md:1},bordered:!0,children:[(0,r.jsx)(M.Z.Item,{label:"\u7F13\u5B58\u72B6\u6001",span:1,children:(0,r.jsxs)(O.Z,{direction:"vertical",style:{width:"100%"},children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{style:{marginRight:8},children:"\u53D1\u9001\u6D88\u606F\u7F13\u5B58\uFF1A"}),(0,r.jsxs)("span",{style:{color:"#1890ff"},children:[I().length," \u6761\u6D88\u606F"]})]}),(0,r.jsx)("div",{style:{fontSize:"12px",color:"#666"},children:"\u672C\u5730\u7F13\u5B58\u7528\u4E8E\u4FDD\u5B58\u53D1\u9001\u7684\u77ED\u4FE1\u8BB0\u5F55\uFF0C\u5373\u4F7F\u5237\u65B0\u9875\u9762\u4E5F\u80FD\u7EE7\u7EED\u663E\u793A\u53D1\u9001\u5386\u53F2"})]})}),(0,r.jsx)(M.Z.Item,{label:"\u7F13\u5B58\u64CD\u4F5C",span:1,children:(0,r.jsxs)(O.Z,{wrap:!0,children:[(0,r.jsx)(j.ZP,{icon:(0,r.jsx)(De.Z,{}),onClick:$e,disabled:I().length===0,children:"\u5BFC\u51FA\u7F13\u5B58"}),(0,r.jsx)(Be.Z,{accept:".json",showUploadList:!1,beforeUpload:function(a){return ze(a),!1},children:(0,r.jsx)(j.ZP,{icon:(0,r.jsx)(be.Z,{}),children:"\u5BFC\u5165\u7F13\u5B58"})}),(0,r.jsx)(j.ZP,{danger:!0,icon:(0,r.jsx)(Q.Z,{}),onClick:He,disabled:I().length===0,children:"\u6E05\u7A7A\u7F13\u5B58"})]})}),(0,r.jsxs)(M.Z.Item,{label:"\u8BBE\u5907\u77ED\u4FE1\u64CD\u4F5C",span:1,children:[(0,r.jsxs)(O.Z,{wrap:!0,children:[(0,r.jsx)(j.ZP,{danger:!0,icon:(0,r.jsx)(Q.Z,{}),onClick:Ge,loading:Re,disabled:!w.enableSMS,children:"\u6E05\u7A7A\u6240\u6709\u77ED\u4FE1"}),!w.enableSMS&&(0,r.jsx)("span",{style:{color:"#999",fontSize:"12px"},children:"(\u8BF7\u5148\u5F00\u542F\u77ED\u4FE1\u529F\u80FD)"})]}),(0,r.jsx)("div",{style:{fontSize:"12px",color:"#666",marginTop:8},children:"\u6B64\u64CD\u4F5C\u5C06\u5220\u9664\u8BBE\u5907\u4E0A\u5B58\u50A8\u7684\u6240\u6709\u77ED\u4FE1\uFF08\u5305\u62EC\u5DF2\u8BFB\u548C\u672A\u8BFB\uFF09\uFF0C\u8BF7\u8C28\u614E\u4F7F\u7528"})]})]})})]})})};X.default=we}}]);
